# XL Spreadsheet - All Deployment Methods

Choose your deployment method based on historical authenticity vs. convenience.

---

## Method Comparison

| Method | Authenticity | Automation | Complexity | Best For |
|--------|--------------|------------|------------|----------|
| **Punched Card Deck** | â˜…â˜…â˜…â˜…â˜… | â˜…â˜…â˜…â˜…â˜… | â˜…â˜…â˜†â˜†â˜† | Historical experience |
| **Batch Job File** | â˜…â˜…â˜…â˜…â˜† | â˜…â˜…â˜…â˜…â˜… | â˜…â˜…â˜†â˜†â˜† | Recommended |
| **Interactive Compilation** | â˜…â˜…â˜…â˜†â˜† | â˜…â˜†â˜†â˜†â˜† | â˜…â˜…â˜…â˜†â˜† | Learning/debugging |
| **Manual Copy/Paste** | â˜…â˜…â˜†â˜†â˜† | â˜†â˜†â˜†â˜†â˜† | â˜…â˜…â˜…â˜…â˜† | Quick testing |

---

## Method 1: Punched Card Deck ğŸ“‡

**Most Historically Authentic**

### What It Is
A simulated deck of 4,003 punched cards containing:
- Job control language (JCL)
- 11 FORTRAN source files
- Compilation commands
- All in 80-column card format

### Files
- `work/xl_deck.txt` (316 KB, 4,003 cards)
- Generated by `scripts/make_card_deck.sh`

### How to Deploy
1. Configure card reader in emulator (if supported)
2. Submit card deck: `SUBMIT CR:`
3. System reads and processes all cards
4. XL compiles automatically
5. Run: `RUN XL`

### Historical Context
In 1978:
- Students carried card decks in boxes or shopping bags
- 4,003 cards â‰ˆ 13 pounds â‰ˆ 26 inches tall
- Card reader speed: ~3 minutes to read entire deck
- Dropped deck = disaster!

### Documentation
See: `CARD_DEPLOYMENT.md`

**Experience Rating: â˜…â˜…â˜…â˜…â˜… Maximum 1978 Authenticity**

---

## Method 2: Batch Job File ğŸ’¼

**Recommended Method**

### What It Is
A Job Control Language (JCL) file that automates compilation using CP-V's batch system.

### Files
- `work/XLBUILD.JOB` (1 KB)
- All 11 source files in `work/` directory

### How to Deploy
1. Connect: `telnet localhost 5001`
2. Login: `:SYS,LBE`
3. Transfer 12 files (11 .FOR + 1 .JOB)
4. Submit batch job: `SUBMIT XLBUILD.JOB`
5. Check status: `STATUS JOBS`
6. When complete, run: `RUN XL`

### Advantages
- âœ… Historically accurate (batch processing was standard)
- âœ… Automated compilation
- âœ… Error logging
- âœ… Reproducible builds
- âœ… Easier than card deck (no card reader needed)

### Documentation
See: `BATCH_DEPLOYMENT.md`, `MANUAL_DEPLOYMENT.md`

**Experience Rating: â˜…â˜…â˜…â˜…â˜† Authentic + Practical**

---

## Method 3: Interactive Compilation ğŸ–¥ï¸

**Step-by-Step Manual Process**

### What It Is
Manually compile each module one at a time using interactive CP-V commands.

### Files
- All 11 source files in `work/` directory

### How to Deploy
1. Connect: `telnet localhost 5001`
2. Login: `:SYS,LBE`
3. Transfer 11 .FOR files
4. For each file:
   ```
   $ RUN FORTRAN
   *SOURCE=filename.FOR
   *OBJECT=filename.OBJ
   *LINK
   $
   ```
5. Link all modules:
   ```
   $ RUN FORTRAN
   *SOURCE=XLMAIN.FOR
   *OBJECT=XLMAIN.OBJ
   *LIBRARY=STRUTIL,CELLS,DEPS,PARSE,EVAL,RECALC,UI,DISPLAY,MSG,TERMCPV
   *LINK
   *MAP
   *GO
   $
   ```
6. Save: `SAVE XL`
7. Run: `RUN XL`

### Advantages
- âœ… Fine-grained control
- âœ… Immediate feedback
- âœ… Good for debugging individual modules
- âœ… Learn CP-V FORTRAN compiler options

### Disadvantages
- âŒ Tedious (11 compile commands)
- âŒ Error-prone (easy to miss a module)
- âŒ Not reproducible

### Documentation
See: `CPV_DEPLOYMENT.md`

**Experience Rating: â˜…â˜…â˜…â˜†â˜† Educational**

---

## Method 4: Magnetic Tape Transfer ğŸ“¼

**Alternative Automated Method**

### What It Is
Transfer files via magnetic tape image.

### Files
- `work/transfer.tap` (created by make_tape.sh)

### How to Deploy
1. Create tape: `./scripts/make_tape.sh work/*.FOR work/XLBUILD.JOB`
2. Attach in emulator: `att mt0 work/transfer.tap`
3. In CP-V:
   ```
   $ COPY MT0: STRUTIL.FOR
   $ COPY MT0: CELLS.FOR
   ...
   $ COPY MT0: XLBUILD.JOB
   $ SUBMIT XLBUILD.JOB
   ```

### Advantages
- âœ… All files in one container
- âœ… Historically accurate (tape was common in 1978)

### Disadvantages
- âŒ Still requires manual COPY commands
- âŒ Batch job method is simpler

### Documentation
See: `QUICKSTART.md`, `CPV_DEPLOYMENT.md`

**Experience Rating: â˜…â˜…â˜…â˜†â˜† Nostalgic**

---

## Quick Reference

### For First-Time Users
ğŸ‘‰ **Start with Method 2** (Batch Job File)
- See `MANUAL_DEPLOYMENT.md`
- Copy/paste 12 files
- Submit batch job
- Done!

### For Historical Enthusiasts
ğŸ‘‰ **Use Method 1** (Punched Card Deck)
- See `CARD_DEPLOYMENT.md`
- Experience real 1978 workflow
- Appreciate modern tools!

### For Learning CP-V
ğŸ‘‰ **Try Method 3** (Interactive)
- See `CPV_DEPLOYMENT.md`
- Understand each compilation step
- Learn FORTRAN compiler options

---

## File Transfer Methods

All deployment methods require transferring files to CP-V. Choose one:

### A. Copy/Paste (Easiest)
```
$ EDIT filename
[Paste file contents]
:FILE
:QUIT
```
Repeat for each file.

### B. Magnetic Tape
```bash
# Host
./scripts/make_tape.sh file1 file2 ...

# CP-V
$ COPY MT0: filename
```
Repeat COPY for each file.

### C. Card Reader (Most Authentic)
```bash
# Host - generate card deck
./scripts/make_card_deck.sh

# CP-V
$ SUBMIT CR:
```
All files and compilation in one submission!

---

## After Deployment

### Run XL Spreadsheet
```
$ RUN XL
```

### You'll See
```
A1  NAV
    A         B         C         D         E         F         G         H
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 1
 2
 3
 ...
```

### Controls
- **Arrow Keys**: Navigate
- **Type number**: Enter value
- **Type formula**: `=A1+B1` [RETURN]
- **ESC**: Cancel
- **/QUIT**: Exit

---

## Troubleshooting

### Compilation Errors

**View output:**
```
$ OUTPUT XLBUILD
```

**Common issues:**
- Missing files: `CATALOG` to verify
- PARAMETER not supported: CP-V F/IV limitation
- Syntax errors: Check file transfer

### Runtime Errors

**Can't find XL:**
```
$ CATALOG XL
```
Should show XL file. If not, compilation failed.

**Screen garbled:**
Your terminal may not support VT-52. Try:
```bash
export TERM=vt100
```
Before connecting.

---

## Documentation Index

- **MANUAL_DEPLOYMENT.md** - Quick-start guide (START HERE!)
- **BATCH_DEPLOYMENT.md** - Batch job details
- **CARD_DEPLOYMENT.md** - Punched card deck guide
- **CPV_DEPLOYMENT.md** - Interactive compilation
- **DEPLOYMENT_STATUS.md** - Current deployment status
- **QUICKSTART.md** - CP-V emulator basics
- **DEPLOYMENT_METHODS.md** - This file

---

## Historical Timeline

**1950s: Batch Processing Era**
- Programs submitted on punched cards
- Jobs run overnight
- Output on paper printouts

**1960s: Time-Sharing Begins**
- Interactive terminals emerge
- But batch still dominant for compilation
- Card decks still standard

**1970s: Mixed Mode (XL Era)**
- Edit code interactively
- Submit batch jobs for compilation
- Both cards and tape used
- **1978: This is where we are!**

**1980s: Interactive Compilation**
- Compilers fast enough for interactive use
- Cards disappearing
- Personal computers emerging

**Today:**
- Instant compilation
- Integrated development environments
- But we can still experience 1978! ğŸ–¥ï¸

---

## Choose Your Adventure

**Maximum Authenticity:** Card Deck (Method 1)
**Best Balance:** Batch Job (Method 2)
**Learning Mode:** Interactive (Method 3)

All roads lead to a working XL Spreadsheet on CP-V! ğŸ¯

---

**Ready to deploy!** Pick your method and jump to its documentation.

**Last Updated:** 2026-01-19
